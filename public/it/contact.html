<section class="reservation-form mt-4">
    <h2>Richiesta generica / Effettua una prenotazione</h2>
    <p>Compila il modulo sottostante per effettuare una prenotazione. Ti risponderemo il prima possibile.</p>

    <form id="reservation-form">
        <div class="form-group">
            <label for="reservation-type">Tipo di Richiesta *</label>
            <select id="reservation-type" name="reservation-type" class="form-control" required>
                <option value="" disabled selected>Seleziona un'opzione</option>
                <option value="prenotazione">Prenotazione Ristorante</option>
                <option value="informazioni">Richiesta Informazioni</option>
                <option value="eventi">Eventi Privati / Wedding</option>
            </select>
        </div>

        <div class="form-row">
            <div class="form-group">
                <label for="name">Nome Completo *</label>
                <input id="name" name="name" class="form-control" type="text" placeholder="Tuo Nome" required>
            </div>
            <div class="form-group">
                <label for="email">Indirizzo Email *</label>
                <input id="email" name="email" class="form-control" type="email" placeholder="latua@email.com" required>
            </div>
        </div>

        <div class="form-row">
            <div class="form-group">
                <label for="phone">Numero di Telefono</label>
                <input id="phone" name="phone" class="form-control" type="tel" placeholder="+39...">
            </div>
            <div class="form-group">
                <label for="date">Data Preferita</label>
                <input id="date" name="date" class="form-control" type="date">
            </div>
        </div>

        <div class="form-row">
            <div class="form-group">
                <label for="time">Orario Preferito</label>
                <input id="time" name="time" class="form-control" type="time">
            </div>
            <div class="form-group">
                <label for="guests">Numero di Ospiti</label>
                <input id="guests" name="guests" class="form-control" type="number" min="1">
            </div>
        </div>

        <div class="form-group">
            <label for="message">Richieste Speciali o Commenti</label>
            <textarea id="message" name="message" class="form-control" rows="4" placeholder="Come possiamo aiutarti?"></textarea>
        </div>

        <button type="submit" id="submit-btn" class="btn btn-primary">Invia Richiesta</button>
        <div id="form-response" style="display:none; margin-top:15px;"></div>
    </form>
</section>

<script>
document.getElementById('reservation-form').addEventListener('submit', function(e) {
    e.preventDefault();
    const form = this;
    const responseDiv = document.getElementById('form-response');
    const submitBtn = document.getElementById('submit-btn');
    const formData = new FormData(form);

    submitBtn.disabled = true;
    submitBtn.innerHTML = "Invio in corso...";

    fetch('https://api.paparemobeach.com/send.php', {
        method: 'POST',
        body: formData
    })
    .then(res => res.json())
    .then(data => {
        if(data.status === "success") {
            responseDiv.innerHTML = "Grazie! La tua richiesta è stata inviata correttamente.";
            responseDiv.style.color = "#155724";
            form.reset();
        } else {
            throw new Error(data.message);
        }
    })
    .catch(() => {
        responseDiv.innerHTML = "Errore nell'invio. Riprova più tardi o contattaci su WhatsApp.";
        responseDiv.style.color = "#721c24";
    })
    .finally(() => {
        responseDiv.style.display = 'block';
        submitBtn.disabled = false;
        submitBtn.innerHTML = "Invia Richiesta";
    });
});
</script>